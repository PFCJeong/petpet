# 1-2: 마우스 클릭 통과 (Click-through) ✅

## 목표
고양이 영역만 클릭 가능하고, 나머지 영역은 클릭이 뒤에 있는 창으로 통과

## 핵심 문제
- `set_ignore_cursor_events(true)` 하면 모든 클릭이 통과됨 (고양이도 클릭 불가)
- 고양이 위에서만 클릭을 받아야 함

## 해결 방법
1. OS 레벨에서 마우스 위치를 직접 가져옴 (core-graphics crate)
2. 프론트엔드에서 고양이 위치를 Rust로 전달
3. Rust에서 16ms마다 마우스가 고양이 위에 있는지 체크
4. 고양이 위 → `ignore_cursor_events(false)` (클릭 허용)
5. 고양이 밖 → `ignore_cursor_events(true)` (클릭 통과)

## 변경된 파일

### 1. `src-tauri/Cargo.toml`
```toml
# macOS에서 마우스 위치 가져오기
core-graphics = "0.24"
```

### 2. `src-tauri/src/lib.rs`
```rust
// 고양이 영역 정보
struct PetBounds {
    x: f64,      // 고양이 중심 X
    y: f64,      // 고양이 중심 Y
    width: f64,  // 고양이 너비
    height: f64, // 고양이 높이
}

// 프론트엔드에서 호출: 고양이 위치 업데이트
#[tauri::command]
fn update_pet_bounds(state, x, y, width, height) { ... }

// macOS에서 마우스 위치 가져오기
fn get_mouse_position() -> Option<(f64, f64)> {
    let source = CGEventSource::new(CGEventSourceStateID::HIDSystemState)?;
    let event = CGEvent::new(source)?;
    Some(event.location())
}

// 백그라운드 스레드: 16ms마다 체크
thread::spawn(|| {
    loop {
        if mouse_over_pet {
            window.set_ignore_cursor_events(false);  // 클릭 허용
        } else {
            window.set_ignore_cursor_events(true);   // 클릭 통과
        }
    }
});
```

### 3. `src/game/PetScene.ts`
```typescript
import { invoke } from '@tauri-apps/api/core'

// 고양이 위치를 Rust 백엔드로 전송
private updatePetBounds() {
    invoke('update_pet_bounds', {
        x: this.pet.x,
        y: this.pet.y,
        width: 64 * scale,
        height: 64 * scale
    })
}

// 초기 위치 전송
create() {
    this.updatePetBounds()
}

// 드래그 중 위치 업데이트
pointermove() {
    this.updatePetBounds()
}
```

## 결과
- 고양이 위에 마우스 → 클릭/드래그 가능
- 고양이 밖 클릭 → 뒤에 있는 창으로 클릭 통과
