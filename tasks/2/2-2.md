# 2-2: 8방향 Idle/Walk 애니메이션 + 자율 배회 ✅

## 목표
고양이를 여우로 교체하고, 8방향 스프라이트로 자율 배회하는 펫 구현

## 변경된 파일

### `src/game/PetScene.ts` (전면 재작성)

#### 상수
```typescript
const FRAME_SIZE = 256      // 스프라이트 한 프레임 크기
const PET_SCALE = 0.5       // 표시 배율 (128px)
const WALK_SPEED = 60       // 이동 속도 (px/초)
const IDLE_MIN_MS = 3000    // IDLE 대기 3~6초
const IDLE_MAX_MS = 6000
const WALK_MIN_MS = 2000    // WALK 이동 2~4초
const WALK_MAX_MS = 4000
const HITBOX_WIDTH = 80     // 클릭 판정 영역
const HITBOX_HEIGHT = 120
```

#### 상태 머신 (3가지 상태)
```
IDLE → (타이머 만료) → WALK → (타이머 만료 or 경계 도달) → IDLE
어떤 상태든 → (클릭) → DRAGGING → (마우스 놓기) → IDLE
```
- `IDLE`: 제자리에서 idle 애니메이션 재생, 3~6초 후 WALK로 전환
- `WALK`: 랜덤 방향 선택, walk 애니메이션 재생하며 이동, 2~4초 후 IDLE로 전환
- `DRAGGING`: 유저가 드래그 중, 자율 행동 일시정지

#### 8방향 벡터
```typescript
// 대각선은 정규화 (√2/2 ≈ 0.707)
const DIRECTION_VECTORS = {
  1: { x: -0.707, y:  0.707 },  // ↙
  2: { x: -1,     y:  0     },  // ←
  3: { x: -0.707, y: -0.707 },  // ↖
  4: { x:  0,     y: -1     },  // ↑
  5: { x:  0.707, y: -0.707 },  // ↗
  6: { x:  1,     y:  0     },  // →
  7: { x:  0.707, y:  0.707 },  // ↘
  8: { x:  0,     y:  1     },  // ↓
}
```

#### 스프라이트 로드 (preload)
```typescript
// 16개 스프라이트 시트 로드 (8방향 × 2동작)
for (dir 1~8) {
  load.spritesheet(`fox_idle_${dir}`, `/assets/idle/Fox_Idle_dir${dir}.png`)
  load.spritesheet(`fox_walk_${dir}`, `/assets/walk/Fox_Walk_dir${dir}.png`)
}
```

#### 애니메이션 생성
```typescript
// 총 16개 애니메이션
fox_idle_1 ~ fox_idle_8  // 각 20프레임, 10fps
fox_walk_1 ~ fox_walk_8  // 각 12프레임, 12fps
```

#### 이동 로직 (update)
```typescript
// 매 프레임 delta(ms)로 프레임 독립적 이동
const dx = vec.x * WALK_SPEED * (delta / 1000)
const dy = vec.y * WALK_SPEED * (delta / 1000)

// 화면 경계 도달 시 IDLE로 전환
if (hitBoundary) startIdle()
```

#### 클릭 판정
```typescript
// 256x256 프레임 중 여우 영역만 클릭 가능하도록 커스텀 hitArea 설정
hitArea: new Phaser.Geom.Rectangle(88, 68, 80, 120)
```

#### 기존 기능 유지
- 드래그 앤 드롭 (드래그 중 idle 애니메이션 표시)
- 호버 시 분홍 틴트
- Rust 백엔드로 위치 전송 (클릭 통과)
- 화면 리사이즈 대응

## Rust 백엔드 변경
없음. `update_pet_bounds(x, y, width, height)` API가 이미 범용적이라 그대로 사용.

## 결과
- 여우가 화면 중앙에서 시작
- 3~6초 대기 후 랜덤 8방향으로 걸어다님
- 2~4초 걷다가 다시 멈춤, 반복
- 화면 끝에 도달하면 멈추고 다음에 새 방향으로 이동
- 드래그로 원하는 위치에 놓을 수 있음
